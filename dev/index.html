<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · Molly.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link href="assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>Molly.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li class="current"><a class="toctext" href>Home</a><ul class="internal"><li><a class="toctext" href="#Installation-1">Installation</a></li><li><a class="toctext" href="#Usage-1">Usage</a></li><li><a class="toctext" href="#Plans-1">Plans</a></li></ul></li><li><a class="toctext" href="docs/">Documentation</a></li></ul></nav><article id="docs"><header><nav><ul><li><a href>Home</a></li></ul><a class="edit-page" href="https://github.com/jgreener64/Molly.jl/blob/master/docs/src/index.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Home</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Molly.jl-1" href="#Molly.jl-1">Molly.jl</a></h1><p><a href="https://travis-ci.org/jgreener64/Molly.jl"><img src="https://travis-ci.org/jgreener64/Molly.jl.svg?branch=master" alt="Travis build status"/></a> <a href="https://ci.appveyor.com/project/jgreener64/molly-jl"><img src="https://ci.appveyor.com/api/projects/status/8dl6lqavnhqigq4p?svg=true" alt="AppVeyor build status"/></a> <a href="https://coveralls.io/github/jgreener64/Molly.jl?branch=master"><img src="https://coveralls.io/repos/github/jgreener64/Molly.jl/badge.svg?branch=master" alt="Coverage Status"/></a> <a href="https://jgreener64.github.io/Molly.jl/dev"><img src="https://img.shields.io/badge/docs-dev-blue.svg" alt="Documentation"/></a></p><p>Much of science can be explained by the movement and interaction of molecules. Molecular dynamics (MD) is a computational technique used to explore these phenomena, particularly for biological macromolecules. Molly.jl is a pure Julia implementation of MD.</p><p>At the minute the package is a proof of concept for MD in Julia. It can simulate a system of atoms with arbitrary interactions as defined by the user. It can also read in pre-computed Gromacs topology and coordinate files with the OPLS-AA forcefield and run MD on proteins with given parameters. In theory it can do this for any regular protein. Implemented features include:</p><ul><li>Interface to allow definition of new forces, thermostats etc.</li><li>Non-bonded interactions - Lennard-Jones Van der Waals/repulsion force, electrostatic Coulomb potential.</li><li>Bonded interactions - covalent bonds, bond angles, dihedral angles.</li><li>Andersen thermostat.</li><li>Velocity Verlet integration.</li><li>Explicit solvent.</li><li>Periodic boundary conditions in a cubic box.</li><li>Neighbour list to speed up calculation of non-bonded forces.</li></ul><p>Features not yet implemented include:</p><ul><li>Speed. Seriously, it&#39;s not fast yet - ~20x slower than GROMACS by some rough calculations. For reference most of the computational time in MD is spent in the force calculation, and most of that in calculation of non-bonded forces.</li><li>Protein force fields other than OPLS-AA.</li><li>Water models.</li><li>Energy minimisation.</li><li>Other temperature or pressure coupling methods.</li><li>Protein preparation - solvent box, add hydrogens etc.</li><li>Trajectory/topology file format readers/writers.</li><li>Trajectory analysis.</li><li>Parallelisation.</li><li>GPU compatibility.</li><li>Unit tests.</li></ul><h2><a class="nav-anchor" id="Installation-1" href="#Installation-1">Installation</a></h2><p>Julia v1.0 or later is required. Install from the Julia REPL. Enter the package mode by pressing <code>]</code> and run <code>add https://github.com/jgreener64/Molly.jl</code>.</p><h2><a class="nav-anchor" id="Usage-1" href="#Usage-1">Usage</a></h2><p>Some examples are given here, see <a href="https://jgreener64.github.io/Molly.jl/dev">the documentation</a> for more.</p><p>Simulation of an ideal gas:</p><pre><code class="language-julia">using Molly

n_atoms = 100
box_size = 2.0 # nm
temperature = 298 # K
mass = 10.0 # Relative atomic mass

atoms = [Atom(mass=mass, σ=0.3, ϵ=0.2) for i in 1:n_atoms]
coords = [Coordinates(rand(3) .* box_size) for i in 1:n_atoms]
velocities = [Velocity(mass, temperature) for i in 1:n_atoms]
general_inters =  Dict(&quot;LJ&quot; =&gt; LennardJones())

s = Simulation(
    simulator=VelocityVerlet(),
    atoms=atoms,
    general_inters=general_inters,
    coords=coords,
    velocities=velocities,
    temperature=temperature,
    box_size=box_size,
    thermostat=AndersenThermostat(1.0),
    loggers=[TemperatureLogger(100)],
    timestep=0.002, # ps
    n_steps=100_000
)

simulate!(s)</code></pre><p>Simulation of a protein:</p><pre><code class="language-julia">using Molly

timestep = 0.0002 # ps
temperature = 298 # K
n_steps = 5000

atoms, specific_inter_lists, general_inters, nb_matrix, coords, box_size = readinputs(
            joinpath(dirname(pathof(Molly)), &quot;..&quot;, &quot;data&quot;, &quot;5XER&quot;, &quot;gmx_top_ff.top&quot;),
            joinpath(dirname(pathof(Molly)), &quot;..&quot;, &quot;data&quot;, &quot;5XER&quot;, &quot;gmx_coords.gro&quot;))

s = Simulation(
    simulator=VelocityVerlet(),
    atoms=atoms,
    specific_inter_lists=specific_inter_lists,
    general_inters=general_inters,
    coords=coords,
    velocities=[Velocity(a.mass, temperature) for a in atoms],
    temperature=temperature,
    box_size=box_size,
    neighbour_finder=DistanceNeighbourFinder(nb_matrix, 10),
    thermostat=AndersenThermostat(1.0),
    loggers=[TemperatureLogger(10), StructureWriter(10, &quot;traj_5XER_1ps.pdb&quot;)],
    timestep=timestep,
    n_steps=n_steps
)

simulate!(s)</code></pre><p>The above 1 ps simulation looks something like this when you output view it in VMD: <img src="https://github.com/jgreener64/Molly.jl/raw/master/data/5XER/sim_1ps.gif" alt="MD simulation"/></p><h2><a class="nav-anchor" id="Plans-1" href="#Plans-1">Plans</a></h2><p>I plan to work on this in my spare time, but progress will be slow. MD could provide a nice use case for Julia - I think a reasonably featured and performant MD program could be written in fewer than 1,000 lines of code for example. Julia is also a well-suited language for trajectory analysis.</p><p>Contributions are very welcome - see the <a href="https://github.com/jgreener64/Molly.jl/issues/2">roadmap issue</a> for more.</p><footer><hr/><a class="next" href="docs/"><span class="direction">Next</span><span class="title">Documentation</span></a></footer></article></body></html>
